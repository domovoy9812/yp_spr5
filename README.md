# Учебный проект на 7 спринт
## Общая информация
Проект состоит из двух приложений:
1. Основное приложение - интернет магазин
2. REST API сервис для выполнения платежей и проверки баланса
### ссылка на репозиторий
https://github.com/domovoy9812/yp_spr5.git
### команда для клонирования репозитория
```git clone https://github.com/domovoy9812/yp_spr5.git```
### структура проекта
1. **data** - модуль отвечает за слой доступа к данным
2. **service** - модуль отвечает за слой бизнес-логики
3. **web** - модуль отвечает за слой представления
4. **main** - Spring Boot модуль для основного приложения
5. **rest-api** модуль содержит Spring Boot приложение, содержащее Rest сервис для платежей и проверки баланса
## Требования для запуска и настройка
### Для работы приложения требуется:
1. Java 21 версии
2. Для запуска приложения в контейнере docker требуется docker (проверено на версии 28.0.4)
3. Для локального запуска приложения требуется запущенный сервер Postgresql 17
+ должна быть создана основная база данных (по умолчанию **bliushtein_yp_sprint5_db**)
+ должен быть создан пользователь для подключения приложения к базе (по умолчанию **bliushtein_yp_sprint5**)
4. Для локального запуска приложения требуется запущенный сервер Redis (проверено на версии 7.4.2)
### Настройка приложения
[application.yml](./main/src/main/resources/application.yml) файл с настройками основного приложения
1. Для локального запуска приложения требуются следующие настройки:

| параметр              | описание                             | значение по умолчанию                                      |
|-----------------------|--------------------------------------|------------------------------------------------------------|
| spring.r2dbc.url      | строка подключения к БД              | r2dbc:postgresql://localhost:5432/bliushtein_yp_sprint5_db |
| spring.r2dbc.username | имя пользователя для подключения к БД | bliushtein_yp_sprint5                                      |
| spring.r2dbc.password | пароль                               | 12345                                                      |
| data.redis.host       | IP адрес Redis сервера               | 127.0.0.1                                                  |
| data.redis.port       | порт Redis сервера                   | 6379                                                       |
| payment-api-url       | URL REST сервиса                     | http://localhost:8081                                      |
2. Для запуска приложения в контейнере docker данные настройки не требуются и при запуске приложения будут проигнорированы
### Сборка и запуск
1. Для сборки проекта нужно выполнить команду ```gradlew clean build```
2. Для локального запуска основного приложения нужно выполнить команду ```gradlew main:bootRun```
3. Для локального запуска REST API приложения нужно выполнить команду ```gradlew rest-api:bootRun```
4. Для запуска всего проекта в контейнере docker нужно выполнить команду ```docker compose up -d```
5. После успешного запуска главная страница основного приложения будет доступна по ссылке http://localhost:8080/main